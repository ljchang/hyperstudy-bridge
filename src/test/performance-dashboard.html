<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HyperStudy Bridge - Performance Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: #0f1419;
        color: #ffffff;
        overflow-x: hidden;
      }

      .header {
        background: linear-gradient(135deg, #1e3a8a, #3730a3);
        padding: 20px;
        border-bottom: 2px solid #374151;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
      }

      .header h1 {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 5px;
      }

      .header p {
        color: #9ca3af;
        font-size: 0.9rem;
      }

      .dashboard {
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: #1f2937;
        border: 1px solid #374151;
        border-radius: 12px;
        padding: 20px;
        transition: all 0.3s ease;
      }

      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
        border-color: #4f46e5;
      }

      .stat-card h3 {
        color: #9ca3af;
        font-size: 0.875rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 10px;
      }

      .stat-value {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .stat-change {
        font-size: 0.875rem;
        font-weight: 500;
      }

      .stat-change.positive {
        color: #10b981;
      }

      .stat-change.negative {
        color: #ef4444;
      }

      .stat-change.neutral {
        color: #6b7280;
      }

      .charts-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .chart-container {
        background: #1f2937;
        border: 1px solid #374151;
        border-radius: 12px;
        padding: 20px;
        height: 400px;
      }

      .chart-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 15px;
        color: #ffffff;
      }

      .chart-wrapper {
        position: relative;
        height: calc(100% - 40px);
      }

      .full-width-chart {
        grid-column: 1 / -1;
      }

      .controls {
        background: #1f2937;
        border: 1px solid #374151;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .controls h3 {
        margin-bottom: 15px;
        color: #ffffff;
      }

      .control-group {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        align-items: center;
      }

      .control-item {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .control-item label {
        color: #9ca3af;
        font-size: 0.875rem;
        white-space: nowrap;
      }

      .control-item input,
      .control-item select {
        background: #374151;
        border: 1px solid #4b5563;
        border-radius: 6px;
        color: #ffffff;
        padding: 8px 12px;
        font-size: 0.875rem;
      }

      .control-item button {
        background: #4f46e5;
        border: none;
        border-radius: 6px;
        color: white;
        padding: 8px 16px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .control-item button:hover {
        background: #4338ca;
      }

      .control-item button.danger {
        background: #dc2626;
      }

      .control-item button.danger:hover {
        background: #b91c1c;
      }

      .status-indicator {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .status-indicator.online {
        background: rgba(16, 185, 129, 0.1);
        color: #10b981;
        border: 1px solid #10b981;
      }

      .status-indicator.offline {
        background: rgba(239, 68, 68, 0.1);
        color: #ef4444;
        border: 1px solid #ef4444;
      }

      .status-indicator.warning {
        background: rgba(245, 158, 11, 0.1);
        color: #f59e0b;
        border: 1px solid #f59e0b;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: currentColor;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .device-list {
        background: #1f2937;
        border: 1px solid #374151;
        border-radius: 12px;
        padding: 20px;
      }

      .device-item {
        display: flex;
        justify-content: between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #374151;
      }

      .device-item:last-child {
        border-bottom: none;
      }

      .device-info {
        flex: 1;
      }

      .device-name {
        font-weight: 600;
        margin-bottom: 4px;
      }

      .device-metrics {
        color: #9ca3af;
        font-size: 0.875rem;
      }

      @media (max-width: 768px) {
        .charts-grid {
          grid-template-columns: 1fr;
        }

        .control-group {
          flex-direction: column;
          align-items: stretch;
        }

        .stats-grid {
          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>HyperStudy Bridge Performance Dashboard</h1>
      <p>Real-time monitoring and performance analytics</p>
    </div>

    <div class="dashboard">
      <div class="controls">
        <h3>Dashboard Controls</h3>
        <div class="control-group">
          <div class="control-item">
            <label>Update Interval:</label>
            <select id="updateInterval">
              <option value="1000">1 second</option>
              <option value="5000" selected>5 seconds</option>
              <option value="10000">10 seconds</option>
              <option value="30000">30 seconds</option>
            </select>
          </div>
          <div class="control-item">
            <label>Time Range:</label>
            <select id="timeRange">
              <option value="300">5 minutes</option>
              <option value="900">15 minutes</option>
              <option value="1800" selected>30 minutes</option>
              <option value="3600">1 hour</option>
            </select>
          </div>
          <div class="control-item">
            <button id="pauseBtn">Pause Updates</button>
          </div>
          <div class="control-item">
            <button id="exportBtn">Export Report</button>
          </div>
          <div class="control-item">
            <button id="resetBtn" class="danger">Reset Data</button>
          </div>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <h3>TTL Pulse Latency</h3>
          <div class="stat-value" style="color: #10b981" id="ttlLatency">0.8ms</div>
          <div class="stat-change positive" id="ttlLatencyChange">-12% from baseline</div>
          <div class="status-indicator online">
            <span class="status-dot"></span>
            Target: <1ms
          </div>
        </div>

        <div class="stat-card">
          <h3>Message Throughput</h3>
          <div class="stat-value" style="color: #3b82f6" id="messageThroughput">1,247/sec</div>
          <div class="stat-change positive" id="throughputChange">+23% from baseline</div>
          <div class="status-indicator online">
            <span class="status-dot"></span>
            Target: >1000/sec
          </div>
        </div>

        <div class="stat-card">
          <h3>Memory Usage</h3>
          <div class="stat-value" style="color: #f59e0b" id="memoryUsage">67MB</div>
          <div class="stat-change neutral" id="memoryChange">+5% from baseline</div>
          <div class="status-indicator online">
            <span class="status-dot"></span>
            Target: <100MB
          </div>
        </div>

        <div class="stat-card">
          <h3>CPU Usage</h3>
          <div class="stat-value" style="color: #6366f1" id="cpuUsage">12%</div>
          <div class="stat-change positive" id="cpuChange">-3% from baseline</div>
          <div class="status-indicator online">
            <span class="status-dot"></span>
            Target: <20%
          </div>
        </div>

        <div class="stat-card">
          <h3>Connected Devices</h3>
          <div class="stat-value" style="color: #10b981" id="connectedDevices">3</div>
          <div class="stat-change neutral" id="devicesChange">No change</div>
          <div class="status-indicator online">
            <span class="status-dot"></span>
            All Online
          </div>
        </div>

        <div class="stat-card">
          <h3>Error Rate</h3>
          <div class="stat-value" style="color: #ef4444" id="errorRate">0.02%</div>
          <div class="stat-change positive" id="errorChange">-45% from baseline</div>
          <div class="status-indicator online">
            <span class="status-dot"></span>
            Target: <1%
          </div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="chart-container">
          <h4 class="chart-title">TTL Pulse Latency Over Time</h4>
          <div class="chart-wrapper">
            <canvas id="latencyChart"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h4 class="chart-title">Message Throughput</h4>
          <div class="chart-wrapper">
            <canvas id="throughputChart"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h4 class="chart-title">System Resource Usage</h4>
          <div class="chart-wrapper">
            <canvas id="resourceChart"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h4 class="chart-title">Device Performance Metrics</h4>
          <div class="chart-wrapper">
            <canvas id="deviceChart"></canvas>
          </div>
        </div>
      </div>

      <div class="chart-container full-width-chart">
        <h4 class="chart-title">Multi-Device Synchronization Timeline</h4>
        <div class="chart-wrapper">
          <canvas id="syncChart"></canvas>
        </div>
      </div>

      <div class="device-list">
        <h3 style="margin-bottom: 15px">Device Status</h3>
        <div id="deviceList">
          <!-- Device items will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <script>
      // Performance Dashboard Implementation
      class PerformanceDashboard {
        constructor() {
          this.charts = {};
          this.data = {
            latency: [],
            throughput: [],
            memory: [],
            cpu: [],
            devices: [],
          };
          this.updateInterval = null;
          this.isPaused = false;

          this.initializeCharts();
          this.startUpdates();
          this.setupEventListeners();
        }

        initializeCharts() {
          // TTL Latency Chart
          this.charts.latency = new Chart(document.getElementById('latencyChart'), {
            type: 'line',
            data: {
              labels: [],
              datasets: [
                {
                  label: 'Latency (ms)',
                  data: [],
                  borderColor: '#10b981',
                  backgroundColor: 'rgba(16, 185, 129, 0.1)',
                  borderWidth: 2,
                  fill: true,
                  tension: 0.4,
                },
                {
                  label: 'Target (<1ms)',
                  data: [],
                  borderColor: '#ef4444',
                  borderDash: [5, 5],
                  borderWidth: 1,
                  pointRadius: 0,
                },
              ],
            },
            options: this.getChartOptions('ms', 0, 2),
          });

          // Throughput Chart
          this.charts.throughput = new Chart(document.getElementById('throughputChart'), {
            type: 'line',
            data: {
              labels: [],
              datasets: [
                {
                  label: 'Messages/sec',
                  data: [],
                  borderColor: '#3b82f6',
                  backgroundColor: 'rgba(59, 130, 246, 0.1)',
                  borderWidth: 2,
                  fill: true,
                  tension: 0.4,
                },
                {
                  label: 'Target (1000/sec)',
                  data: [],
                  borderColor: '#f59e0b',
                  borderDash: [5, 5],
                  borderWidth: 1,
                  pointRadius: 0,
                },
              ],
            },
            options: this.getChartOptions('msg/sec', 0, 2000),
          });

          // Resource Usage Chart
          this.charts.resource = new Chart(document.getElementById('resourceChart'), {
            type: 'line',
            data: {
              labels: [],
              datasets: [
                {
                  label: 'CPU (%)',
                  data: [],
                  borderColor: '#6366f1',
                  backgroundColor: 'rgba(99, 102, 241, 0.1)',
                  borderWidth: 2,
                  yAxisID: 'y',
                },
                {
                  label: 'Memory (MB)',
                  data: [],
                  borderColor: '#f59e0b',
                  backgroundColor: 'rgba(245, 158, 11, 0.1)',
                  borderWidth: 2,
                  yAxisID: 'y1',
                },
              ],
            },
            options: {
              ...this.getChartOptions(),
              scales: {
                x: this.getTimeScale(),
                y: {
                  type: 'linear',
                  display: true,
                  position: 'left',
                  title: { display: true, text: 'CPU (%)', color: '#9ca3af' },
                  grid: { color: '#374151' },
                  ticks: { color: '#9ca3af' },
                  max: 100,
                },
                y1: {
                  type: 'linear',
                  display: true,
                  position: 'right',
                  title: { display: true, text: 'Memory (MB)', color: '#9ca3af' },
                  grid: { drawOnChartArea: false },
                  ticks: { color: '#9ca3af' },
                  max: 200,
                },
              },
            },
          });

          // Device Performance Chart
          this.charts.device = new Chart(document.getElementById('deviceChart'), {
            type: 'radar',
            data: {
              labels: ['Latency', 'Throughput', 'Reliability', 'Sync Accuracy', 'Data Quality'],
              datasets: [
                {
                  label: 'TTL Device',
                  data: [95, 85, 98, 92, 90],
                  borderColor: '#10b981',
                  backgroundColor: 'rgba(16, 185, 129, 0.1)',
                  borderWidth: 2,
                },
                {
                  label: 'Kernel fNIRS',
                  data: [88, 95, 94, 89, 96],
                  borderColor: '#3b82f6',
                  backgroundColor: 'rgba(59, 130, 246, 0.1)',
                  borderWidth: 2,
                },
                {
                  label: 'Pupil Labs',
                  data: [82, 90, 91, 87, 93],
                  borderColor: '#f59e0b',
                  backgroundColor: 'rgba(245, 158, 11, 0.1)',
                  borderWidth: 2,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { labels: { color: '#9ca3af' } },
              },
              scales: {
                r: {
                  beginAtZero: true,
                  max: 100,
                  ticks: { color: '#9ca3af' },
                  grid: { color: '#374151' },
                  pointLabels: { color: '#9ca3af' },
                },
              },
            },
          });

          // Synchronization Timeline Chart
          this.charts.sync = new Chart(document.getElementById('syncChart'), {
            type: 'scatter',
            data: {
              datasets: [
                {
                  label: 'TTL Events',
                  data: [],
                  backgroundColor: '#10b981',
                  borderColor: '#10b981',
                  pointRadius: 6,
                },
                {
                  label: 'fNIRS Events',
                  data: [],
                  backgroundColor: '#3b82f6',
                  borderColor: '#3b82f6',
                  pointRadius: 6,
                },
                {
                  label: 'Gaze Events',
                  data: [],
                  backgroundColor: '#f59e0b',
                  borderColor: '#f59e0b',
                  pointRadius: 6,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { labels: { color: '#9ca3af' } },
              },
              scales: {
                x: this.getTimeScale(),
                y: {
                  title: { display: true, text: 'Device', color: '#9ca3af' },
                  grid: { color: '#374151' },
                  ticks: {
                    color: '#9ca3af',
                    callback: function (value) {
                      const devices = ['TTL', 'fNIRS', 'Gaze'];
                      return devices[Math.floor(value)] || '';
                    },
                  },
                  min: 0,
                  max: 2,
                },
              },
            },
          });
        }

        getChartOptions(yLabel = '', yMin = null, yMax = null) {
          return {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { labels: { color: '#9ca3af' } },
            },
            scales: {
              x: this.getTimeScale(),
              y: {
                title: { display: !!yLabel, text: yLabel, color: '#9ca3af' },
                grid: { color: '#374151' },
                ticks: { color: '#9ca3af' },
                ...(yMin !== null && { min: yMin }),
                ...(yMax !== null && { max: yMax }),
              },
            },
          };
        }

        getTimeScale() {
          return {
            type: 'time',
            time: {
              unit: 'second',
              displayFormats: { second: 'HH:mm:ss' },
            },
            title: { display: true, text: 'Time', color: '#9ca3af' },
            grid: { color: '#374151' },
            ticks: { color: '#9ca3af' },
          };
        }

        generateMockData() {
          const now = new Date();
          const timeRange = parseInt(document.getElementById('timeRange').value) * 1000;

          // Generate TTL latency data
          const latency = 0.3 + Math.random() * 0.7; // 0.3-1.0ms
          this.updateDataSeries('latency', now, latency, timeRange);

          // Generate throughput data
          const throughput = 800 + Math.random() * 800; // 800-1600 msg/sec
          this.updateDataSeries('throughput', now, throughput, timeRange);

          // Generate resource data
          const cpu = 5 + Math.random() * 20; // 5-25%
          const memory = 40 + Math.random() * 60; // 40-100MB
          this.updateDataSeries('cpu', now, cpu, timeRange);
          this.updateDataSeries('memory', now, memory, timeRange);

          // Update UI values
          this.updateStatistics(latency, throughput, memory, cpu);
          this.updateDeviceList();
        }

        updateDataSeries(type, time, value, maxAge) {
          if (!this.data[type]) this.data[type] = [];

          this.data[type].push({ x: time, y: value });

          // Remove old data
          const cutoff = new Date(time.getTime() - maxAge);
          this.data[type] = this.data[type].filter(point => point.x >= cutoff);
        }

        updateStatistics(latency, throughput, memory, cpu) {
          document.getElementById('ttlLatency').textContent = `${latency.toFixed(2)}ms`;
          document.getElementById('messageThroughput').textContent =
            `${Math.round(throughput).toLocaleString()}/sec`;
          document.getElementById('memoryUsage').textContent = `${Math.round(memory)}MB`;
          document.getElementById('cpuUsage').textContent = `${Math.round(cpu)}%`;

          // Update status indicators
          this.updateStatusIndicator('ttlLatency', latency < 1.0);
          this.updateStatusIndicator('messageThroughput', throughput > 1000);
          this.updateStatusIndicator('memoryUsage', memory < 100);
          this.updateStatusIndicator('cpuUsage', cpu < 20);
        }

        updateStatusIndicator(statId, isGood) {
          const card = document.getElementById(statId).closest('.stat-card');
          const indicator = card.querySelector('.status-indicator');

          if (isGood) {
            indicator.className = 'status-indicator online';
          } else {
            indicator.className = 'status-indicator warning';
          }
        }

        updateDeviceList() {
          const deviceList = document.getElementById('deviceList');
          const devices = [
            {
              name: 'TTL Pulse Generator',
              type: 'Adafruit RP2040',
              status: 'online',
              latency: '0.8ms',
              throughput: '50 pulses/min',
              accuracy: '99.2%',
            },
            {
              name: 'Kernel Flow2 fNIRS',
              type: 'TCP/IP Device',
              status: 'online',
              latency: '2.1ms',
              throughput: '1000 Hz',
              accuracy: '98.7%',
            },
            {
              name: 'Pupil Labs Neon',
              type: 'WebSocket Device',
              status: 'online',
              latency: '16.7ms',
              throughput: '60 Hz',
              accuracy: '94.3%',
            },
          ];

          deviceList.innerHTML = devices
            .map(
              device => `
                    <div class="device-item">
                        <div class="device-info">
                            <div class="device-name">${device.name}</div>
                            <div class="device-metrics">${device.type} • Latency: ${device.latency} • Rate: ${device.throughput}</div>
                        </div>
                        <div class="status-indicator ${device.status}">
                            <span class="status-dot"></span>
                            ${device.accuracy}
                        </div>
                    </div>
                `
            )
            .join('');
        }

        updateCharts() {
          if (this.isPaused) return;

          // Update latency chart
          const latencyChart = this.charts.latency;
          latencyChart.data.labels = this.data.latency.map(p => p.x);
          latencyChart.data.datasets[0].data = this.data.latency;
          latencyChart.data.datasets[1].data = this.data.latency.map(() => 1.0); // Target line
          latencyChart.update('none');

          // Update throughput chart
          const throughputChart = this.charts.throughput;
          throughputChart.data.labels = this.data.throughput.map(p => p.x);
          throughputChart.data.datasets[0].data = this.data.throughput;
          throughputChart.data.datasets[1].data = this.data.throughput.map(() => 1000); // Target line
          throughputChart.update('none');

          // Update resource chart
          const resourceChart = this.charts.resource;
          resourceChart.data.labels = this.data.cpu.map(p => p.x);
          resourceChart.data.datasets[0].data = this.data.cpu;
          resourceChart.data.datasets[1].data = this.data.memory;
          resourceChart.update('none');

          // Update sync chart with mock events
          this.updateSyncChart();
        }

        updateSyncChart() {
          const syncChart = this.charts.sync;
          const now = new Date();

          // Occasionally add synchronized events
          if (Math.random() < 0.1) {
            // 10% chance per update
            const baseTime = now.getTime();
            syncChart.data.datasets[0].data.push({ x: baseTime, y: 0 });
            syncChart.data.datasets[1].data.push({ x: baseTime + 2, y: 1 });
            syncChart.data.datasets[2].data.push({ x: baseTime + 5, y: 2 });

            // Keep only recent events
            const cutoff = now.getTime() - 300000; // 5 minutes
            syncChart.data.datasets.forEach(dataset => {
              dataset.data = dataset.data.filter(point => point.x > cutoff);
            });

            syncChart.update('none');
          }
        }

        startUpdates() {
          const interval = parseInt(document.getElementById('updateInterval').value);

          if (this.updateInterval) {
            clearInterval(this.updateInterval);
          }

          this.updateInterval = setInterval(() => {
            this.generateMockData();
            this.updateCharts();
          }, interval);

          // Initial update
          this.generateMockData();
          this.updateCharts();
        }

        setupEventListeners() {
          document.getElementById('updateInterval').addEventListener('change', () => {
            this.startUpdates();
          });

          document.getElementById('timeRange').addEventListener('change', () => {
            // Clear existing data when time range changes
            Object.keys(this.data).forEach(key => {
              this.data[key] = [];
            });
          });

          document.getElementById('pauseBtn').addEventListener('click', () => {
            this.isPaused = !this.isPaused;
            document.getElementById('pauseBtn').textContent = this.isPaused
              ? 'Resume Updates'
              : 'Pause Updates';
          });

          document.getElementById('exportBtn').addEventListener('click', () => {
            this.exportReport();
          });

          document.getElementById('resetBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all performance data?')) {
              Object.keys(this.data).forEach(key => {
                this.data[key] = [];
              });
              Object.values(this.charts).forEach(chart => chart.update());
            }
          });
        }

        exportReport() {
          const report = {
            timestamp: new Date().toISOString(),
            summary: {
              avgLatency:
                this.data.latency.length > 0
                  ? (
                      this.data.latency.reduce((sum, p) => sum + p.y, 0) / this.data.latency.length
                    ).toFixed(3)
                  : 'N/A',
              avgThroughput:
                this.data.throughput.length > 0
                  ? Math.round(
                      this.data.throughput.reduce((sum, p) => sum + p.y, 0) /
                        this.data.throughput.length
                    )
                  : 'N/A',
              avgCpu:
                this.data.cpu.length > 0
                  ? (this.data.cpu.reduce((sum, p) => sum + p.y, 0) / this.data.cpu.length).toFixed(
                      1
                    )
                  : 'N/A',
              avgMemory:
                this.data.memory.length > 0
                  ? Math.round(
                      this.data.memory.reduce((sum, p) => sum + p.y, 0) / this.data.memory.length
                    )
                  : 'N/A',
            },
            data: this.data,
          };

          const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `hyperstudy-bridge-performance-${new Date().toISOString().split('T')[0]}.json`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }
      }

      // Initialize dashboard when page loads
      document.addEventListener('DOMContentLoaded', () => {
        new PerformanceDashboard();
      });
    </script>
  </body>
</html>
